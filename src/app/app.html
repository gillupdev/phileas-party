<div class="page">
  <div class="container">
    <div class="card">
      <div class="header">
        <span class="badge">23 Mars 2025</span>
        <h1>Phileas</h1>
        <p>fête ses 8 ans !</p>
      </div>

      @if (error()) {
        <div class="error-message">
          {{ error() }}
        </div>
      }

      @if (showForm()) {
        <div class="form-group">
          <label for="name">Ton prénom</label>
          <input
            id="name"
            type="text"
            placeholder="Entre ton prénom..."
            [ngModel]="guestName()"
            (ngModelChange)="guestName.set($event)"
            [disabled]="loading()"
          />
        </div>
        <div class="btn-group">
          <button
            class="btn btn-primary"
            (click)="submitRSVP(true)"
            [disabled]="!guestName().trim() || loading()"
          >
            {{ loading() ? '...' : 'Je viens !' }}
          </button>
          <button
            class="btn btn-secondary"
            (click)="submitRSVP(false)"
            [disabled]="!guestName().trim() || loading()"
          >
            {{ loading() ? '...' : 'Pas dispo' }}
          </button>
        </div>
      } @else {
        <div class="confirmation">
          <p>Merci {{ lastSubmittedName }} !</p>
          <button class="btn-link" (click)="resetForm()">
            Ajouter quelqu'un d'autre
          </button>
        </div>
      }

      @if (attendingGuests.length > 0 || notAttendingGuests.length > 0) {
        <div class="divider"></div>
        <div class="guests">
          @if (attendingGuests.length > 0) {
            <div class="guest-col">
              <h3>Présents <span>{{ attendingGuests.length }}</span></h3>
              <ul class="guest-list">
                @for (guest of attendingGuests; track guest.id) {
                  <li>{{ guest.name }}</li>
                }
              </ul>
            </div>
          }
          @if (notAttendingGuests.length > 0) {
            <div class="guest-col absent">
              <h3>Absents <span>{{ notAttendingGuests.length }}</span></h3>
              <ul class="guest-list">
                @for (guest of notAttendingGuests; track guest.id) {
                  <li>{{ guest.name }}</li>
                }
              </ul>
            </div>
          }
        </div>
      }
    </div>
  </div>
</div>
