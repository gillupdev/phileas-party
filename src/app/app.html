<div class="page">
  <div class="hero">
    <div class="hero-content">
      <div class="badge">
        <span class="age">8</span>
        <span class="ans">ans</span>
      </div>
      <h1>PHILEAS</h1>
      <div class="tagline">fête son anniversaire</div>
      <div class="date-block">
        <div class="date-icon">&#128197;</div>
        <div class="date-info">
          <span class="day">23</span>
          <span class="month">MARS</span>
        </div>
      </div>
    </div>
  </div>

  <div class="main-content">
    <!-- Error Message -->
    @if (error()) {
      <div class="error-box">
        <span>&#9888;</span> {{ error() }}
      </div>
    }

    <!-- RSVP Form -->
    @if (showForm()) {
      <div class="rsvp-card">
        <h2>Tu viens ?</h2>
        <input
          type="text"
          placeholder="Entre ton prénom"
          [ngModel]="guestName()"
          (ngModelChange)="guestName.set($event)"
          class="input-field"
          [disabled]="loading()"
        />
        <div class="btn-row">
          <button
            class="btn btn-confirm"
            (click)="submitRSVP(true)"
            [disabled]="!guestName().trim() || loading()"
          >
            @if (loading()) {
              <span class="loader"></span>
            } @else {
              OUI, JE SERAI LÀ !
            }
          </button>
          <button
            class="btn btn-decline"
            (click)="submitRSVP(false)"
            [disabled]="!guestName().trim() || loading()"
          >
            @if (loading()) {
              <span class="loader"></span>
            } @else {
              NON, DÉSOLÉ
            }
          </button>
        </div>
      </div>
    } @else {
      <div class="thank-you-card">
        @if (submitted()) {
          <div class="check-icon">&#10003;</div>
          <h2>Merci !</h2>
          <p>Ta réponse a été enregistrée</p>
          <button class="btn btn-secondary" (click)="resetForm()">
            Ajouter un autre invité
          </button>
        }
      </div>
    }

    <!-- Guest Lists -->
    <div class="guests-section">
      @if (attendingGuests.length > 0) {
        <div class="guest-card coming">
          <div class="guest-header">
            <span class="guest-count">{{ attendingGuests.length }}</span>
            <span class="guest-label">{{ attendingGuests.length === 1 ? 'invité confirmé' : 'invités confirmés' }}</span>
          </div>
          <div class="guest-list">
            @for (guest of attendingGuests; track guest.id) {
              <span class="guest-chip">{{ guest.name }}</span>
            }
          </div>
        </div>
      }

      @if (notAttendingGuests.length > 0) {
        <div class="guest-card not-coming">
          <div class="guest-header">
            <span class="guest-count">{{ notAttendingGuests.length }}</span>
            <span class="guest-label">{{ notAttendingGuests.length === 1 ? 'ne peut pas venir' : 'ne peuvent pas venir' }}</span>
          </div>
          <div class="guest-list">
            @for (guest of notAttendingGuests; track guest.id) {
              <span class="guest-chip">{{ guest.name }}</span>
            }
          </div>
        </div>
      }
    </div>
  </div>

  <footer>
    <p>On t'attend avec impatience !</p>
  </footer>
</div>
